---
title: 环境变量与上下文
---

:::info

您正在查看 Deno Deploy<sup>EA</sup> 的文档。正在寻找 Deploy Classic 的文档？[请点击这里查看](/deploy/)。

:::

在 Deno Deploy<sup>EA</sup> 中，可以使用环境变量来通过一些静态值（例如 API 密钥或数据库连接字符串）配置应用程序。

环境变量可以存储为纯文本值，也可以存储为密钥。纯文本值可从 UI 中查看，适用于非敏感值，如功能开关。密钥永远不会在 UI 中显示，只能在应用代码中以纯文本形式读取。密钥应用于敏感值，如 API 密钥。

环境变量可以设置在应用级别或组织级别。应用级环境变量针对特定应用设置，组织级环境变量则作用于整个组织。组织级环境变量会被组织中所有应用继承，但可被应用级环境变量覆盖。

每个环境变量适用于一个或多个上下文。上下文是您代码运行的逻辑“环境”。每个上下文拥有自己的一套环境变量和密钥。默认情况下，有两个上下文：

- **生产（Production）**：生产上下文用于生产时间线，服务于生产流量。

- **开发（Development）**：开发上下文用于开发时间线，服务于所有非生产流量。用于预览 URL 和分支 URL。

:::info

需要更多上下文？请联系[支持](../support)。

:::

在应用或组织内部，不能存在同名且适用于相同上下文的多个环境变量。但可以存在同名且适用于不同且不重叠上下文的多个环境变量。

## 添加、编辑和删除环境变量

可以在多个地方添加环境变量：

- 在创建新应用的“新建应用”页面，通过点击“添加/编辑环境变量”按钮。

- 在应用设置页面的“环境变量”部分，点击“编辑”按钮。

- 在组织设置页面的“环境变量”部分，点击“编辑”按钮。

环境变量抽屉将会打开，您可以在其中添加或删除环境变量。环境变量抽屉中所做的任何更改仅在点击“保存”按钮后生效。若要放弃更改，可点击“取消”按钮关闭抽屉且不保存。

要添加新的环境变量，点击“添加环境变量”按钮，填写名称、值、是否为密钥，以及其应应用的上下文。

也可以通过导入 `.env` 文件批量添加多个环境变量。方法是在环境变量抽屉中点击“+ 从 .env 文件添加”，粘贴 `.env` 文件内容，点击“导入变量”。以 `#` 开头的行会作为注释被忽略。

要删除环境变量，点击想要删除的环境变量旁边的“删除”按钮。

要编辑环境变量，点击要编辑的环境变量旁边的“编辑”按钮。您可以更改名称、值，将纯文本变量改为密钥，并编辑其应用的上下文。

保存更改后，点击“保存”按钮。若想放弃更改，可以点击“取消”按钮关闭抽屉且不保存。

## 在代码中使用环境变量

可以通过 `Deno.env.get` API 在代码中访问环境变量。

例如，访问名为 `MY_ENV_VAR` 的环境变量，可以使用以下代码：

```ts
const myEnvVar = Deno.env.get("MY_ENV_VAR");
```

## 预定义环境变量

Deno Deploy<sup>EA</sup> 提供了一组自动为每个应用设置的预定义环境变量。这些环境变量在所有上下文中均可用，可用于访问有关应用及其运行环境的信息。

- `DENO_DEPLOYMENT_ID` - 表示应用运行的完整配置集的唯一标识符。该配置包含应用 ID、修订 ID、上下文以及任何适用的环境变量。上述任何一项改变时，此值也会更改。

- `DENO_REVISION_ID` - 当前正在运行的修订 ID。

未来还会添加更多预定义环境变量。

无法手动设置任何以 `DENO_*` 开头的环境变量。这些环境变量由 Deno Deploy<sup>EA</sup> 设置，且只读。