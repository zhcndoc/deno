---
title: 缓存
description: "Deno Deploy 早期访问中的 CDN 缓存功能概览，涵盖缓存配置、指令及最佳实践。"
---

:::info

您正在查看 Deno Deploy<sup>EA</sup> 的文档。正在寻找 Deploy Classic 的文档？[请点击这里查看](/deploy/)。

:::

Deno Deploy<sup>EA</sup> 内置了一个 CDN，可以缓存您的应用响应。这对于静态资源（如图片、CSS 和 JavaScript 文件）以及不经常更改的 API 响应或服务器渲染页面非常有用。

默认情况下，所有应用程序都启用了缓存。只有具有有效缓存头的资源才会被缓存。

Deno Deploy<sup>EA</sup> 直接集成了许多框架，如 Next.js，以自动集成缓存，实现 ISR 等功能。

CDN 缓存绑定到修订版本和上下文。这意味着如果您部署了一个新修订版本，缓存将被失效，现有缓存的响应将不再提供。这有助于确保用户始终看到您应用的最新版本。但请注意，如果 `Cache-Control` 头设置的值允许，浏览器缓存可能仍会提供过时的响应。

## 缓存资源

要缓存资源，您需要在响应中设置 `Cache-Control` 头。`Cache-Control` 是一个标准的 HTTP 头，控制响应在浏览器和 CDN 中的缓存方式。

Deno Deploy<sup>EA</sup> 支持以下缓存指令：

- `max-age`：响应被视为新鲜状态的最大时间长度。超过此时间，响应被视为过时，将重新验证服务器。此规则也适用于浏览器缓存。
- `s-maxage`：响应被视为新鲜状态的最大时间长度，适用于共享缓存（例如 CDN）。超过此时间，响应被视为过时，将重新验证服务器。不适用于浏览器缓存。
- `stale-while-revalidate`：响应在重新与服务器验证时，仍被视为新鲜的最大时间。允许 CDN 在获取新响应时提供过时的响应。
- `stale-if-error`：如果服务器返回错误，响应仍被视为新鲜的最大时间。允许 CDN 在获取新响应时提供过时的响应。
- `immutable`：响应是不可变的且不会改变。允许 CDN 无限期缓存响应。这对于不会变化的静态资源（如图片或 CSS 文件）非常有用。
- `no-store`：响应不应被缓存。适用于不应缓存的动态响应，如 API 响应或服务器渲染页面。
- `no-cache`：响应在从缓存提供之前应重新验证服务器。适用于可能频繁变化的动态响应。

`Vary` 头可用于指定哪些请求头应作为请求缓存键的一部分。

`Expires` 头可用于指定响应的绝对过期时间。这是 `max-age` 指令的替代方法。