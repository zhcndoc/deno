---
title: 域名
description: "Deno Deploy 早期访问中的域管理完整指南，包括组织域、自定义域、DNS 配置、TLS 证书和域分配。"
---

:::info

你正在查阅 Deno Deploy<sup>EA</sup> 的文档。想查看 Deploy Classic 版本的文档？[点此查看](/deploy/)。

:::

每个组织都拥有一个默认域名，用于生产环境、git 分支和预览 URL，适用于在该组织中部署的应用程序。例如，组织 `acme-inc` 的默认组织域名为 `acme-inc.deno.net`。一个名为 `my-app` 的应用程序，其默认生产域名会是 `my-app.acme-inc.deno.net`。

除了 Deno Deploy<sup>EA</sup> 自动提供的默认域名外，还可以为应用程序添加自定义域名。自定义域名是指你拥有并控制的域名。要添加自定义域名，你必须从域名注册商处购买该域名，并且你必须有权限编辑该域名的 DNS 记录。

自定义域名归属于一个组织。添加后，它可以绑定到该组织中的任何应用程序。

自定义域名可以作为基础域名（单个域名或子域名，例如 `example.com`）或者通配符域名（例如 `*.example.com`）进行添加。基础域名可以供单一应用程序使用。通配符域名更具灵活性，可以完全指派给单一应用程序，让所有子域名指向该应用程序，或者部分指派给多个应用程序，使得某个子域名指向某个应用程序，另一个子域名指向不同的应用程序。

每个自定义域名必须拥有有效的 TLS 证书，才能在 Deno Deploy<sup>EA</sup> 中使用。Deno Deploy<sup>EA</sup> 可以通过 Let's Encrypt 自动为你申请 TLS 证书。

## 添加自定义域名

要添加自定义域名，请前往组织的域名页面。你可以通过点击 Deno Deploy<sup>EA</sup> 仪表盘左上角的组织名称，然后点击顶部导航中的“域名”标签，进入该页面。

点击“添加域名”按钮，打开自定义域名抽屉。在抽屉中输入你想添加的域名，例如 `example.com`。然后选择是仅添加此域名本身，还是同时添加通配符子域名（`*.example.com`）。

点击“添加域名”按钮确认。

此时你会看到域名配置抽屉。

### DNS 配置

域名配置抽屉包含该域名的 DNS 配置，用于验证域名所有权、生成 TLS 证书、以及将流量路由到 Deno Deploy<sup>EA</sup>。

DNS 配置部分通常有两到三个标签页，具体取决于你要添加的域名类型。你必须将这些标签页中的所有 DNS 记录添加到你的域名注册商的 DNS 配置中。由于不同的域名注册商对某些 DNS 记录的支持程度不同，存在多种添加方式：

- 如果你的域名注册商支持 `ANAME` 或 `ALIAS` 记录，则首选 `ANAME/ALIAS` 方法。使用该方法时，只需在 DNS 配置中添加一个 `ANAME` 或 `ALIAS` 记录以及一个 `CNAME` 记录。

- `CNAME` 方法适用于子域名，但不支持基础域名。使用此方法时，同一域名下不能有其他 DNS 记录（如用于电子邮件的 `MX` 记录），因此只适合不需要其他 DNS 记录的子域名。在 DNS 配置中添加两个单独的 `CNAME` 记录。

- `A` 方法最为灵活且支持广泛，但需要添加更多的 DNS 记录。使用该方法时，需添加一个 `A` 记录和一个 `CNAME` 记录。

> 目前 Deno Deploy<sup>EA</sup> 还不支持 IPv6。此功能未来会推出。当采用 `ANAME/ALIAS` 或 `CNAME` 配置方式时，域名会自动配置支持 IPv6（如果支持的话）。使用 `A` 方式时，我们会通过邮件通知你需要添加一个 `AAAA` 记录。

:::warning

在使用 Cloudflare 作为 DNS 提供商时，**必须**禁用 `_acme-challenge` CNAME 记录的代理（即将云朵颜色从橙色变为灰色）。否则验证和证书申请将会失败。

:::

### 验证

一旦域名的 DNS 记录被添加到注册商的 DNS 配置中，Deno Deploy<sup>EA</sup> 会检查这些 DNS 记录，以验证域名所有权。此过程可能会花费几分钟，具体时间取决于 DNS 服务提供商。在验证进行中，你可以保持域名配置抽屉开启，它会在验证完成后自动刷新。一旦验证成功，你会看到一个绿色对勾。

你也可以手动点击“申请证书”按钮来触发验证过程。如果验证成功，也会同时启动 TLS 证书的申请流程。

### TLS 证书申请

验证通过后，你可以点击“申请证书”按钮，触发 TLS 证书的自动申请。此操作会自动使用 Let's Encrypt 生成域名的 TLS 证书，可能需要最多 90 秒。

证书生成完成后，你会看到证书的相关信息，比如到期时间和签发时间。

TLS 证书会在临近到期时自动续约。你可以在域名配置抽屉中查看当前的证书状态。

## 将自定义域名分配给应用

在组织中添加了自定义域名后，可以将其分配给该组织中的任何应用程序。要操作：进入组织的域名页面，点击任意自定义域名旁边的“分配”按钮。

这会打开分配域名抽屉。在抽屉中选择你希望绑定的应用。如果使用通配符域名，还可以选择是绑定基础域名、通配符子域名，还是某个特定子域名。

选择完毕后，点击“分配域名”按钮确认。

## 从应用中取消绑定自定义域名

要取消绑定应用中的自定义域名，进入应用设置页面，在“自定义域名”区域使用“删除”按钮移除对应的自定义域名。

这样会解除该应用与自定义域名的绑定，但不会删除该域名在组织中的注册记录。该自定义域名依然可以用于组织中的其他应用。

## 移除自定义域名

要从组织中移除自定义域名，前往组织的域名页面，打开对应的域名配置抽屉。点击“删除”按钮，确认操作，即可将该域名从组织中删除，并同时删除所有应用中的相关绑定信息。